import{a as Ie,r as s,g as B,i as Ue,j as Pe,c as p,o as v,d as w,w as o,e as l,f as u,h as x,k as E,t as W,n as ge}from"./index-e5d93ad7.js";import{u as ze}from"./getCitys-8975380a.js";import{u as Ae}from"./getCompanies-04b9ee77.js";import{u as Fe}from"./getMachines-42d8bca2.js";const{getToken:Ne,token:U}=Ie();Ne();const Te=()=>{const X=s([]);return{getData:async()=>{try{const{data:i}=await B.get("/envios");X.value=i}catch(i){console.log(i)}},crearEnvioPost:async(i,n,d,f,g)=>{const b=n.value,h=d.value;try{let _={headers:{token:U}};const{data:y}=await B.post("/envios/",{idMaquina:i,ciudad:b,empresa:h,numeroGuia:f,motivoEnvio:g},_);return y}catch(_){return _}},editarEnvio:async(i,n,d,f,g,b)=>{const h=d.value,_=f.value;try{let y={headers:{token:U}};const{data:P}=await B.put(`/envios/${i}`,{idMaquina:n,ciudad:h,empresa:_,numeroGuia:g,motivoEnvio:b},y);return P}catch(y){return y}},inactivarEnvio:async i=>{try{let n={headers:{token:U}};const{data:d}=await B.put(`envios/desactivar/${i}`,{},n);return d}catch(n){console.log(n)}},activarEnvio:async i=>{try{let n={headers:{token:U}};const{data:d}=await B.put(`envios/activar/${i}`,{},n);return d}catch(n){console.log(n)}},crearIMG:async(i,n)=>{try{let d=new FormData;d.append("archivo",n);let f={headers:{token:U}};if(n!=null){console.log(d);const{data:g}=await B.put(`/envios/cargarCloud/${i}`,d,f);return g}else return"Error"}catch(d){return d}},editarIMG:async()=>{try{let i=new FormData;i.append("archivo",imgGuide);let n={headers:{token:U}};if(imgGuide!=null){console.log(i);const{data:d}=await B.put(`/envios/imgEditar/${id}`,i,n);return d}else return"Error"}catch(i){return i}},sends:X}};const Le={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 q-pa-sm q-mb-md"},Oe={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 q-pa-sm q-mb-md"},je={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 q-pa-sm q-mb-md"},Re={class:"col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 q-pa-sm"},He={class:"col-12 q-pa-sm"},Je={class:"container-input"},Ke={for:"file-5"},Qe=u("figure",null,[u("svg",{xmlns:"http://www.w3.org/2000/svg",class:"iborrainputfile",width:"20",height:"17",viewBox:"0 0 20 17"},[u("path",{d:"M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"})])],-1),We={key:0,class:"iborrainputfile"},Xe={key:1,class:"iborrainputfile"},Ye={key:0,class:"text-green"},Ze={key:1,class:"text-red"},ea={key:0,class:"text-green"},aa={key:1,class:"text-red"},oa=u("div",{class:"text-h5 text-weight-bold text-center"}," ¿Desea crear un equipo? ",-1),la={class:"col-12 q-pa-sm"},ta={class:"col-12 q-pa-sm"},na={class:"col-12 q-pa-sm"},sa={class:"col-12 q-pa-sm"},ia={key:0,class:"text-green"},ra={key:1,class:"text-orange"},ua=u("span",{class:"text-green"},"'Recivido'",-1),da=u("span",{class:"text-orange"},"'Enviado'",-1),fa={__name:"Send",setup(X){const m=Ue("$swal"),r=Te(),Y=ze(),Z=Ae(),S=Fe(),q=s([]),re=[{name:"equipo",label:"Equipo",align:"center",field:"equipo"},{name:"ciudad",label:"Ciudad",align:"center",field:"ciudad"},{name:"empresa",label:"Empresa",align:"center",field:"empresa",sortable:!0},{name:"numeroGuia",label:"Numero de guía",align:"center",field:"numeroGuia"},{name:"motivoEnvio",label:"Motivo del envío",align:"center",field:"motivoEnvio"},{name:"imgGuia",label:"IMG-GUÍA",align:"center",field:"imgGuia"},{name:"estado",label:"Estado",align:"center",field:"estado",sortable:!0},{name:"opciones",label:"Opciones",align:"center",field:"opciones"}],i=s(""),n=s(!1),d=s(""),f=s(""),g=s(""),b=s(""),h=s(""),_=s(""),y=s(0),P=s(0),_e=async()=>{const t=await r.crearEnvioPost(f.value,g.value,b.value,h.value,_.value);t.msg?(n.value=!1,m.fire({icon:"success",title:t.msg,showConfirmButton:!1,timer:2500}),te(),await r.getData(),q.value=r.sends.value):(n.value=!1,m.fire({position:"top-end",icon:"error",title:t.response.data.errores.errors[0].msg,showConfirmButton:!1,timer:1500}),setTimeout(()=>{n.value=!0},1500))},we=t=>{P.value=1,y.value=1,f.value=t.idMaquina._id,j.value=t.idMaquina.nombre,d.value=t._id,g.value={label:t.ciudad.ciudad,value:t.ciudad._id},b.value={label:t.empresa.nombre,value:t.empresa._id},h.value=t.numeroGuia,_.value=t.motivoEnvio,n.value=!0},be=async()=>{const t=await r.editarEnvio(d.value,f.value,g.value,b.value,h.value,_.value);t.msg?(n.value=!1,m.fire({icon:"success",title:t.msg,showConfirmButton:!1,timer:2500}),te(),await r.getData(),q.value=r.sends.value):(n.value=!1,m.fire({position:"top-end",icon:"error",title:t.response.data.errores.errors[0].msg,showConfirmButton:!1,timer:1500}),setTimeout(()=>{n.value=!0},1500))},he=async t=>{const a=await r.activarEnvio(t);a.msg?(m.fire({icon:"success",title:a.msg,showConfirmButton:!1,timer:1500}),await r.getData(),q.value=r.sends.value):m.fire({position:"top-end",icon:"error",title:"Inicia sesión nuevamente",showConfirmButton:!1,timer:1500})},ye=async t=>{const a=await r.inactivarEnvio(t);a.msg?(m.fire({icon:"success",title:a.msg,showConfirmButton:!1,timer:1500}),await r.getData(),q.value=r.sends.value):m.fire({position:"top-end",icon:"error",title:"Inicia sesión nuevamente",showConfirmButton:!1,timer:1500})},ee=s(0),z=s(!1),V=s(""),A=s(""),qe=t=>{V.value=t.target.files[0],console.log(V.value)},Ce=t=>{z.value=!0,A.value=t},ke=async()=>{const t=await r.crearIMG(A.value,V.value);console.log(t),t.url?(m.fire({icon:"success",title:"Imagen agregada con exito",showConfirmButton:!1,timer:1500}),await r.getData(),q.value=r.sends.value,ae()):m.fire({position:"top-end",icon:"error",title:"Error intenta nuevamente",showConfirmButton:!1,timer:1500})},xe=t=>{z.value=!0,A.value=t,ee.value=1},Ee=async()=>{const t=await r.crearIMG(A.value,V.value);console.log(t),t.url?(m.fire({icon:"success",title:"Imagen editada con exito",showConfirmButton:!1,timer:1500}),await r.getData(),q.value=r.sends.value,ae()):m.fire({position:"top-end",icon:"error",title:"Error intenta nuevamente",showConfirmButton:!1,timer:1500})},ae=()=>{z.value=!1,A.value="",ee.value=0,V.value=""};let oe=[],ue={};const de=s(oe);function Ve(t,a,c){a(()=>{const D=t.toLowerCase();de.value=oe.filter(I=>I.label.toLowerCase().indexOf(D)>-1)})}let le=[];const ce=s(le);function Me(t,a,c){a(()=>{const D=t.toLowerCase();ce.value=le.filter(I=>I.label.toLowerCase().indexOf(D)>-1)})}const te=()=>{ve(),P.value=0,d.value="",f.value="",g.value="",b.value="",h.value="",_.value="",n.value=!1},C=s(!1),ne=s([]),se=s(""),j=s(""),Ge=[{name:"nombre",label:"Nombre",align:"center",field:"nombre"},{name:"serial",label:"Serial",align:"center",field:"serial",sortable:!0},{name:"af",label:"AF",align:"center",field:"af",sortable:!0},{name:"estado",label:"Estado",align:"center",field:"estado",sortable:!0},{name:"estadoMaquina",label:"Estado la maquina",align:"center",field:"estadoMaquina",sortable:!0},{name:"seleccionar",label:"Seleccionar",align:"center",field:"seleccionar"}],$e=t=>{f.value=t._id,j.value=t.nombre,y.value=1,C.value=!1},ve=()=>{y.value=0,f.value="",j.value=""},M=s(!1),F=s(""),N=s(""),T=s(""),L=s({label:"En buen estado",value:1}),Be=[{label:"En buen estado",value:1},{label:"En mal estado",value:0}],Se=async()=>{const t=await S.crearMachinePost(F.value,N.value,T.value,L.value);t.msg?(n.value=!1,C.value=!1,M.value=!1,m.fire({icon:"success",title:t.msg,showConfirmButton:!1,timer:2500}),setTimeout(()=>{n.value=!0,C.value=!0},2500),me(),await S.getData(),ne.value=S.machines.value):(n.value=!1,C.value=!1,M.value=!1,m.fire({position:"top-end",icon:"error",title:t.response.data.errores.errors[0].msg,showConfirmButton:!1,timer:1500}),setTimeout(()=>{n.value=!0,C.value=!0,M.value=!0},1500))},me=()=>{M.value=!1,F.value="",N.value="",T.value="",L.value={label:"En buen estado",value:1}};return Pe(async()=>{await r.getData(),await Y.getData(),await Z.getData(),await S.getData(),q.value=r.sends.value,ne.value=S.machines.value,Y.citys.value.forEach(t=>{ue={label:t.ciudad,value:t._id},oe.push(ue)}),le=Z.companiesOptions}),(t,a)=>{const c=p("q-btn"),D=p("q-item-section"),I=p("q-item"),ie=p("q-select"),G=p("q-input"),R=p("q-card-section"),H=p("q-card-actions"),J=p("q-card"),K=p("q-dialog"),Q=p("q-icon"),k=p("q-td"),$=p("q-tooltip"),pe=p("q-table"),fe=p("q-img"),De=p("q-page");return v(),w(De,{class:"q-pa-xl text-center"},{default:o(()=>[l(K,{modelValue:n.value,"onUpdate:modelValue":a[9]||(a[9]=e=>n.value=e),persistent:"","transition-show":"rotate","transition-hide":"rotate"},{default:o(()=>[l(J,{style:{width:"700px","max-width":"80vw"}},{default:o(()=>[l(R,{class:"row"},{default:o(()=>[u("div",Le,[y.value===1?(v(),w(c,{key:0,outline:"",rounded:"",icon:"highlight_off",class:"full-width",style:{height:"56px"},label:j.value,onClick:a[0]||(a[0]=e=>ve())},null,8,["label"])):(v(),w(c,{key:1,rounded:"",color:"black dark",class:"full-width",style:{height:"56px"},label:"Agregar equipo",onClick:a[1]||(a[1]=e=>C.value=!0)}))]),u("div",Oe,[l(ie,{rounded:"",outlined:"",modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=e=>g.value=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:de.value,onFilter:Ve,label:"Selecciona una ciudad"},{"no-option":o(()=>[l(I,null,{default:o(()=>[l(D,{class:"text-grey"},{default:o(()=>[x(" Sin resultados ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),u("div",je,[l(ie,{rounded:"",outlined:"",modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e),"use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:ce.value,onFilter:Me,label:"Selecciona una empresa"},{"no-option":o(()=>[l(I,null,{default:o(()=>[l(D,{class:"text-grey"},{default:o(()=>[x(" Sin resultados ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),u("div",Re,[l(G,{rounded:"",outlined:"",modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=e=>h.value=e),label:"Numero de guía*","lazy-rules":"",rules:[e=>e&&e.length>0||"Porfavor ingresa el numero de guía"]},null,8,["modelValue","rules"])]),u("div",He,[l(G,{rounded:"",outlined:"",modelValue:_.value,"onUpdate:modelValue":a[5]||(a[5]=e=>_.value=e),label:"Motivo de envío*","lazy-rules":"",rules:[e=>e&&e.length>0||"Porfavor el motivo"]},null,8,["modelValue","rules"])])]),_:1}),l(H,{align:"right"},{default:o(()=>[l(c,{rounded:"",outline:"",label:"Cancelar",color:"red",onClick:a[6]||(a[6]=e=>te())}),P.value===0?(v(),w(c,{key:0,rounded:"",outline:"",label:"Aceptar",color:"green",onClick:a[7]||(a[7]=e=>_e())})):(v(),w(c,{key:1,rounded:"",outline:"",label:"Editar",color:"green",onClick:a[8]||(a[8]=e=>be())}))]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(K,{modelValue:z.value,"onUpdate:modelValue":a[13]||(a[13]=e=>z.value=e),persistent:"","transition-show":"rotate","transition-hide":"rotate"},{default:o(()=>[l(J,{style:{width:"600px","max-width":"80vw"}},{default:o(()=>[l(R,{class:"text-right"},{default:o(()=>[u("div",Je,[u("input",{type:"file",name:"file-5",id:"file-5",onChange:qe,class:"inputfile inputfile-5","data-multiple-caption":"{count} archivos seleccionados",multiple:""},null,32),u("label",Ke,[Qe,V.value===""?(v(),E("span",We,"Subir archivo")):(v(),E("span",Xe,W(V.value.name),1))])])]),_:1}),l(H,{align:"right"},{default:o(()=>[l(c,{rounded:"",outline:"",label:"Cancelar",color:"red",onClick:a[10]||(a[10]=e=>ae())}),ee.value===0?(v(),w(c,{key:0,rounded:"",outline:"",label:"Aceptar",color:"green",onClick:a[11]||(a[11]=e=>ke())})):(v(),w(c,{key:1,rounded:"",outline:"",label:"Editar",color:"green",onClick:a[12]||(a[12]=e=>Ee())}))]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(K,{modelValue:C.value,"onUpdate:modelValue":a[17]||(a[17]=e=>C.value=e),persistent:"","transition-show":"rotate","transition-hide":"rotate"},{default:o(()=>[l(J,{style:{width:"800px","max-width":"80vw"}},{default:o(()=>[l(R,{class:"row justify-center"},{default:o(()=>[l(pe,{dense:t.$q.screen.lt.md,flat:"",bordered:"",title:"Equipos",filter:se.value,rows:ne.value,columns:Ge,"row-key":"_id"},{"top-right":o(()=>[l(G,{color:"black",modelValue:se.value,"onUpdate:modelValue":a[14]||(a[14]=e=>se.value=e),placeholder:"Buscar"},{append:o(()=>[l(Q,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-estado":o(e=>[l(k,{props:e},{default:o(()=>[e.row.estado===1?(v(),E("span",Ye," Activo ")):(v(),E("span",Ze," Inactivo "))]),_:2},1032,["props"])]),"body-cell-estadoMaquina":o(e=>[l(k,{props:e},{default:o(()=>[e.row.estadoMaquina===1?(v(),E("span",ea," Buen estado ")):(v(),E("span",aa," Mal estado "))]),_:2},1032,["props"])]),"body-cell-seleccionar":o(e=>[l(k,{props:e},{default:o(()=>[l(c,{outline:"",rounded:"",color:"green",icon:"add_circle_outline",onClick:O=>$e(e.row)},{default:o(()=>[l($,null,{default:o(()=>[x("Seleccionar este equipo")]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["dense","filter","rows"])]),_:1}),oa,l(H,{align:"center"},{default:o(()=>[l(c,{rounded:"",outline:"",label:"Cancelar",color:"red",onClick:a[15]||(a[15]=e=>C.value=!1)}),l(c,{rounded:"",outline:"",label:"Aceptar",color:"green",onClick:a[16]||(a[16]=e=>M.value=!0)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(K,{modelValue:M.value,"onUpdate:modelValue":a[24]||(a[24]=e=>M.value=e),persistent:"","transition-show":"rotate","transition-hide":"rotate"},{default:o(()=>[l(J,{style:{width:"700px","max-width":"80vw"}},{default:o(()=>[l(R,{class:"row"},{default:o(()=>[u("div",la,[l(G,{rounded:"",outlined:"",modelValue:F.value,"onUpdate:modelValue":a[18]||(a[18]=e=>F.value=e),label:"Nombre*","lazy-rules":"",rules:[e=>e&&e.length>0||"Porfavor ingresa el nombre del equipo"]},null,8,["modelValue","rules"])]),u("div",ta,[l(G,{rounded:"",outlined:"",modelValue:N.value,"onUpdate:modelValue":a[19]||(a[19]=e=>N.value=e),label:"Serial*","lazy-rules":"",rules:[e=>e&&e.length>0||"Porfavor ingresa el serial"]},null,8,["modelValue","rules"])]),u("div",na,[l(G,{rounded:"",outlined:"",modelValue:T.value,"onUpdate:modelValue":a[20]||(a[20]=e=>T.value=e),label:"AF*","lazy-rules":"",rules:[e=>e&&e.length>0||"Porfavor ingresa el af del equipo"]},null,8,["modelValue","rules"])]),u("div",sa,[l(ie,{rounded:"",outlined:"",modelValue:L.value,"onUpdate:modelValue":a[21]||(a[21]=e=>L.value=e),options:Be,label:"Estado del equipo"},null,8,["modelValue"])])]),_:1}),l(H,{align:"right"},{default:o(()=>[l(c,{rounded:"",outline:"",label:"Cancelar",color:"red",onClick:a[22]||(a[22]=e=>me())}),l(c,{rounded:"",outline:"",label:"Aceptar",color:"green",onClick:a[23]||(a[23]=e=>Se(F.value,N.value,T.value,L.value))})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(c,{rounded:"",color:"green",class:"q-mb-md",icon:"add_circle",label:"Crea un envío",onClick:a[25]||(a[25]=e=>n.value=!0)},{default:o(()=>[l($,null,{default:o(()=>[x("Crear Envío")]),_:1})]),_:1}),l(pe,{dense:t.$q.screen.lt.md,flat:"",bordered:"",title:"Envíos",filter:i.value,rows:q.value,columns:re,"row-key":"_id"},{"top-right":o(()=>[l(G,{color:"black",modelValue:i.value,"onUpdate:modelValue":a[26]||(a[26]=e=>i.value=e),placeholder:"Buscar"},{append:o(()=>[l(Q,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-equipo":o(e=>[l(k,{props:e},{default:o(()=>[u("span",null,W(e.row.idMaquina.nombre),1)]),_:2},1032,["props"])]),"body-cell-ciudad":o(e=>[l(k,{props:e},{default:o(()=>[u("span",null,W(e.row.ciudad.ciudad),1)]),_:2},1032,["props"])]),"body-cell-empresa":o(e=>[l(k,{props:e},{default:o(()=>[u("span",null,W(e.row.empresa.nombre),1)]),_:2},1032,["props"])]),"body-cell-imgGuia":o(e=>[l(k,{props:e},{default:o(()=>[e.row.imgGuia?(v(),w(fe,{key:0,src:e.row.imgGuia,ratio:16/9},{default:o(()=>[l(Q,{class:"absolute all-pointer-events",size:"25px",name:"edit",color:"primary",onClick:O=>xe(e.row._id),style:{top:"5%",left:"5%",cursor:"pointer"}},{default:o(()=>[l($,null,{default:o(()=>[x(" Editar imagen ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["src"])):(v(),w(fe,{key:1,src:"../src/assets/imgNotFoud.png",ratio:16/9},{default:o(()=>[l(Q,{class:"absolute all-pointer-events",size:"25px",name:"add_a_photo",color:"green",onClick:O=>Ce(e.row._id),style:{top:"5%",left:"5%",cursor:"pointer"}},{default:o(()=>[l($,null,{default:o(()=>[x(" Añadir imagen ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024))]),_:2},1032,["props"])]),"body-cell-estado":o(e=>[l(k,{props:e},{default:o(()=>[e.row.estado===1?(v(),E("span",ia," Enviado ")):(v(),E("span",ra," Recivido "))]),_:2},1032,["props"])]),"body-cell-opciones":o(e=>[l(k,{props:e},{default:o(()=>[l(c,{outline:"",rounded:"",color:"primary",icon:"edit",onClick:O=>we(e.row)},{default:o(()=>[l($,null,{default:o(()=>[x("Editar envío")]),_:1})]),_:2},1032,["onClick"]),e.row.estado===1?(v(),w(c,{key:0,class:ge(e.row.estado==1?"q-mx-sm":""),outline:"",rounded:"",color:"red",icon:"remove_moderator",onClick:O=>ye(e.row._id)},{default:o(()=>[l($,null,{default:o(()=>[x("Marcar como "),ua]),_:1})]),_:2},1032,["class","onClick"])):(v(),w(c,{key:1,class:ge(e.row.estado==0?"q-mx-sm":""),outline:"",rounded:"",color:"green",icon:"verified_user",onClick:O=>he(e.row._id)},{default:o(()=>[l($,null,{default:o(()=>[x("Marcar como "),da]),_:1})]),_:2},1032,["class","onClick"]))]),_:2},1032,["props"])]),_:1},8,["dense","filter","rows"])]),_:1})}}};export{fa as default};
